## 프롬프트

WTVB01-485 진동 센서를 사용한 모터 이상 진동 감지 및 모니터링 프로그램을 개발해주세요.

### 개발 환경 및 기술 스택
- **OS**: Windows
- **언어**: Python
- **주요 라이브러리**: PyQt5, Matplotlib, pyserial, pymodbus, numpy, scipy
- **통신**: RS-485 (Modbus RTU) via USB Serial Converter

### 센서 사양 (WTVB01-485)
- **기본 통신 설정**: 
  - 기본 Modbus 주소: 0x50
  - 기본 Baud Rate: 9600 (변경 가능: 4800~230400)
  - 프로토콜: Modbus RTU
  
- **출력 데이터**:
  - 3축 가속도 (AX, AY, AZ): Register 0x34~0x36
  - 3축 진동 속도 (VX, VY, VZ): Register 0x3A~0x3C, 단위: mm/s, 범위: 0~100mm/s
  - 3축 진동 변위 (DX, DY, DZ): Register 0x41~0x43, 단위: um, 범위: 0~30000um
  - 3축 진동 주파수 (HX, HY, HZ): Register 0x44~0x46, 단위: Hz, 범위: 5~100Hz
  - 칩 온도 (TEMP): Register 0x40, 단위: 0.01°C

- **데이터 읽기 예시**:
  ```
  Send: 50 03 00 3A 00 03 28 47  (3축 진동 속도 읽기)
  Return: 50 03 06 VXH VXL VYH VYL VZH VZL CRCH CRCL
  ```

### 필수 기능

#### 1. 실시간 데이터 수집 및 시각화
- 3축 진동 속도, 변위, 주파수를 실시간 그래프로 표시
- 각 축별로 독립적인 그래프 제공 (총 9개 그래프 또는 탭으로 구분)
- 시간축 기준 스크롤링 그래프 (최근 N초 데이터 표시)
- 현재값 디지털 표시 (숫자로도 표시)
- 온도 모니터링 그래프

#### 2. 이상 진동 감지 알고리즘
- **FFT 분석**: 
  - 진동 데이터의 주파수 스펙트럼 분석
  - 특정 주파수 대역의 진폭 증가 감지
  - FFT 결과 실시간 표시 (파워 스펙트럼)
  
- **통계적 이상 감지**:
  - RMS (Root Mean Square) 값 계산 및 모니터링
  - 피크값 (Peak) 감지
  - 이동 평균 대비 급격한 변화 감지
  - 표준편차 기반 이상치 탐지

- **임계값 기반 알람**:
  - 각 측정값(속도, 변위, 주파수)별 임계값 설정
  - 다단계 알람 (주의/경고/위험)
  - 지속 시간 기반 필터링 (순간적 노이즈 제거)

#### 3. 사용자 설정 인터페이스
- **임계값 설정 UI**:
  - 각 축, 각 파라미터별 독립 설정
  - 주의/경고/위험 3단계 임계값
  - 설정값 저장/불러오기 (JSON 파일)

- **알람 설정**:
  - 시각적 경고 (색상 변경, 깜빡임)
  - 청각적 경고 (비프음, 사운드 파일)
  - 로그 자동 기록

#### 4. 통신 관리
- **자동 포트 감지**:
  - 사용 가능한 모든 COM 포트 스캔
  - CH340/CP2102 등 USB-Serial 드라이버 자동 인식
  - 포트 연결 상태 실시간 모니터링

- **연결 관리**:
  - 포트/Baud Rate 수동 선택 옵션
  - 자동 재연결 기능
  - 통신 에러 처리 및 복구

#### 5. 추가 기능
- **데이터 로깅**:
  - CSV/Excel 형식으로 데이터 저장
  - 타임스탬프 포함
  - 알람 이벤트 로그 별도 저장

- **히스토리 분석**:
  - 저장된 데이터 불러오기 및 재분석
  - 시간대별 트렌드 분석
  - 보고서 생성 (PDF/HTML)

- **센서 설정**:
  - Modbus 주소 변경
  - Baud Rate 변경
  - 센서 재시작/초기화

- **대시보드**:
  - 전체 상태 한눈에 보기
  - 각 축의 종합 건강도 표시 (색상 코드)
  - 가동 시간, 알람 발생 횟수 통계

### UI/UX 요구사항
- PyQt5로 모던한 GUI 구현
- 탭 또는 도킹 윈도우 구조
- 다크/라이트 테마 지원
- 반응형 레이아웃
- 상태바에 연결 상태, 데이터 수신률 표시

### 코드 구조
- 클래스 기반 객체지향 설계
- MVC 패턴 권장
- 멀티스레딩으로 UI와 데이터 수집 분리
- 에러 처리 및 로깅 완비
- 설정 파일 관리 (config.json)

### 참고사항
- 센서는 최소 5Hz 이상의 진동만 정확히 측정
- 정확도: ±4% FS
- 고속 모드(1000Hz)는 변위만 출력하므로 일반 모드 사용
- CRC 체크섬 검증 필수

완전히 동작하는 Python 프로그램을 artifact로 작성해주세요. 필요한 모든 모듈과 클래스를 포함하고, 실행 가능한 main 함수를 구현해주세요.